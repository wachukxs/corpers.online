<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="">

    <title>Where? What? When? Corpers Online</title>

    <!-- Bootstrap core CSS -->
    <link href="bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <!-- <link href="jumbotron.css" rel="stylesheet"> -->

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA==" crossorigin="" />

    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js" integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA==" crossorigin=""></script>

    <!--Leaflet Routing Machine is easy.--------------- -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.css" />
    <script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.js"></script>


    <!-- Load Esri Leaflet from CDN -->
    <script src="https://unpkg.com/esri-leaflet@2.2.3/dist/esri-leaflet.js" integrity="sha512-YZ6b5bXRVwipfqul5krehD9qlbJzc6KOGXYsDjU9HHXW2gK57xmWl2gU6nAegiErAqFXhygKIsWPKbjLPXVb2g==" crossorigin=""></script>

    <!--jquery-->
    <script src="jquery-3.3.1.min.js"></script>
    <script src="bootstrap.min.js"></script>

    
    <style>
        body {
            font-family: arial, helvetica;
        }

        @media (min-width: 576px) {

            .collapse>.card-body {
                height: 65vh;
                overflow-y: scroll;
            }

            .parent {
                grid-template-columns: 2fr 3fr;
                padding: 5px;
            }

            .item:nth-child(1) {
                order: -1;
            }

            .item:nth-child(2) {
                order: 1;
            }

        }

        .parent {
            display: grid;

            /* justify-content: center; */

            grid-column-gap: 20px;
            height: 100vh;
        }

        .shw {
            max-width: 100%;
            height: auto;
        }

        @media (max-width: 576px) {
            .parent {
                grid-template-rows: 2fr 3fr;
            }

            .item:nth-child(1) {
                order: 1;
                padding: 5px;
            }

            .item:nth-child(2) {
                order: -1;
            }

            .wrapper {
                display: grid;
                grid-gap: 10px;
                grid-template-columns: 85%;
                grid-auto-flow: column;
                grid-auto-columns: 85%;
                width: -moz-available;
                overflow-x: scroll;
            }
        }
    </style>

</head>

<body>

    <main role="main">
        <div class="parent">
            <div class="section-one item">
                <div class="thelist" id="tl">
                    <div class="" id="accordionExample">
                        <div class="card">
                            <div class="card-header" id="headingOne">
                                <h5 class="mb-0">
                                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                        Collapsible Group Item #1
                                    </button>
                                </h5>
                            </div>
                            <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordionExample">
                                <div class="card-body">
                                    <div class="wrapper">
                                        <div class="card flex-md-row mb-4 box-shadow h-md-250">
                                            <div class="card-body d-flex flex-column align-items-start hover">
                                                <strong class="d-inline-block mb-2 text-primary">World</strong>
                                                <h3 class="mb-0">
                                                    <a class="text-dark" href="#!">Featured post</a>
                                                </h3>
                                                <div class="mb-1 text-muted">Nov 12</div>
                                                <p class="card-text mb-auto">This is a wider card with supporting text below as a natural lead-in to
                                                    additional content.</p>
                                                <a href="#!">Continue reading</a>
                                            </div>
                                            <img class="card-img-right flex-auto d-none d-lg-block shw" src="1000x1000.png" data-holder-rendered="true">
                                        </div>
                                        <div class="card flex-md-row mb-4 box-shadow h-md-250">
                                            <div class="card-body d-flex flex-column align-items-start hover">
                                                <strong class="d-inline-block mb-2 text-primary">World</strong>
                                                <h3 class="mb-0">
                                                    <a class="text-dark" href="#!">Featured post</a>
                                                </h3>
                                                <div class="mb-1 text-muted">Nov 12</div>
                                                <p class="card-text mb-auto">This is a wider card with supporting text below as a natural lead-in to
                                                    additional content.</p>
                                                <a href="#!">Continue reading</a>
                                            </div>
                                            <img class="card-img-right flex-auto d-none d-lg-block shw" alt="Thumbnail [200x250]" src="1564743287029.png" data-holder-rendered="true">
                                        </div>
                                        <div class="card flex-md-row mb-4 box-shadow h-md-250">
                                            <div class="card-body d-flex flex-column align-items-start hover">
                                                <strong class="d-inline-block mb-2 text-primary">World</strong>
                                                <h3 class="mb-0">
                                                    <a class="text-dark" href="#!">Featured post</a>
                                                </h3>
                                                <div class="mb-1 text-muted">Nov 12</div>
                                                <p class="card-text mb-auto">This is a wider card with supporting text below as a natural lead-in to
                                                    additional content.</p>
                                                <a href="#!">Continue reading</a>
                                            </div>
                                            <img class="card-img-right flex-auto d-none d-lg-block shw" alt="Thumbnail [200x250]" src="1564743087802.png" data-holder-rendered="true">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header" id="headingTwo">
                                <h5 class="mb-0">
                                    <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                        Collapsible Group Item #2
                                    </button>
                                </h5>
                            </div>
                            <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample">
                                <div class="card-body">
                                    <div>
                                        Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3 wolf moon officia aute, non cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird on it squid single-origin coffee nulla assumenda shoreditch et. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident. Ad vegan excepteur butcher vice lomo. Leggings occaecat craft beer farm-to-table, raw denim aesthetic synth nesciunt you probably haven't heard of them accusamus labore sustainable VHS.
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header" id="headingThree">
                                <h5 class="mb-0">
                                    <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                                        Collapsible Group Item #3
                                    </button>
                                </h5>
                            </div>
                            <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordionExample">
                                <div class="card-body">
                                    Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quasi placeat voluptatum aspernatur aliquam tempora qui esse, sit similique vitae officiis aut ex neque dicta. Quas commodi sit itaque doloremque neque.
                                    Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quasi placeat voluptatum aspernatur aliquam tempora qui esse, sit similique vitae officiis aut ex neque dicta. Quas commodi sit itaque doloremque neque.
                                    Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quasi placeat voluptatum aspernatur aliquam tempora qui esse, sit similique vitae officiis aut ex neque dicta. Quas commodi sit itaque doloremque neque.
                                    Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quasi placeat voluptatum aspernatur aliquam tempora qui esse, sit similique vitae officiis aut ex neque dicta. Quas commodi sit itaque doloremque neque.
                                    Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quasi placeat voluptatum aspernatur aliquam tempora qui esse, sit similique vitae officiis aut ex neque dicta. Quas commodi sit itaque doloremque neque.
                                    Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quasi placeat voluptatum aspernatur aliquam tempora qui esse, sit similique vitae officiis aut ex neque dicta. Quas commodi sit itaque doloremque neque.
                                    Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quasi placeat voluptatum aspernatur aliquam tempora qui esse, sit similique vitae officiis aut ex neque dicta. Quas commodi sit itaque doloremque neque.
                                    Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quasi placeat voluptatum aspernatur aliquam tempora qui esse, sit similique vitae officiis aut ex neque dicta. Quas commodi sit itaque doloremque neque.
                                    Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quasi placeat voluptatum aspernatur aliquam tempora qui esse, sit similique vitae officiis aut ex neque dicta. Quas commodi sit itaque doloremque neque.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
    
            </div>
            <div class="section-two item" id="mapid">
    
            </div>
        </div>

        <script>
            var mymap = L.map( 'mapid', {
                    tilt: true,
                    zoomControl: false
                } )
                .setView( [ 5.5216578, 7.5066884 ], 16 );
            L.tileLayer(
                    'https://api.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiY2h1a3MwMDciLCJhIjoiY2psOW1iZ2x0MXRoczNycGJwdzhpOGZhbCJ9.z03GKFAu-scE70Z1JKagOg', {
                        attribution: '<a href="https://www.openstreetmap.org/">OpenStreetMap</a>, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, <a href="https://www.mapbox.com/">Mapbox</a>',
                        maxZoom: 18,
                        id: 'mapbox.streets',
                        accessToken: 'pk.eyJ1IjoiY2h1a3MwMDciLCJhIjoiY2psOW1iZ2x0MXRoczNycGJwdzhpOGZhbCJ9.z03GKFAu-scE70Z1JKagOg'
                    } )
                .addTo( mymap );

            // A simple scale control that shows the scale of the current center of screen in metric (m/km) and imperial (mi/ft) systems
            L.control.scale()
                .addTo( mymap );

            here = <%= ( nop !== undefined ? nop : 'undefined' ) %> ;
            console.log( 'here.length', here, here.length );
            if ( here !== undefined & here.length > 0 ) { // if the array is not empty...
                console.log( 'creating popup:', <%- nop %> );

                /* var popup = L.popup()
                  .setLatLng(<%- nop %>[0].properties.ppa_geodata.latlng)
                  .setContent('<p>Hello world!<br />This is a nice popup.</p>')
                  .openOn(mymap); */

                var local_pharmacyIcon = L.icon( {
                    iconUrl: 'https://icon.now.sh/local_pharmacy',
                    iconSize: [ 30, 30 ],
                    iconAnchor: [ 22, 94 ],
                    popupAnchor: [ -3, -76 ],
                    shadowUrl: null,
                    shadowSize: [ 68, 95 ],
                    shadowAnchor: [ 22, 94 ],
                    className: 'custom-icons' // no space between class name
                } );

                console.log( here[ 0 ], here[ 0 ].properties.ppa_geodata.latlng );
                // [here[0].properties.ppa_geodata.longitude, here[0].properties.ppa_geodata.latitude]
                /* L.marker(here.properties.ppa_geodata.latlng, { // using image is better, icon changes position on zoom change
                  icon: local_pharmacyIcon
                }).addTo(mymap).bindPopup("A print shop."); */
                L.marker( here[ 0 ].properties.ppa_geodata.latlng )
                    .addTo( mymap )
                    .bindPopup( here[ 0 ].properties.ppa_address + '<br> <i class="text-muted">' + here[ 0 ].properties.type_of_ppa + '</i> ' )
                    .openPopup();
                mymap.setView( here[ 0 ].properties.ppa_geodata.latlng );

                // to do show the get direction control when ever a ppa is shown from exteral clicks
                // if users leave where their marker is, show a control that can go back there
            }
        </script>

        <% if (ppas.length > 0) { %>
        <%# {"latlng":{"lat":7.413782299999999,"lng":3.9155568},"bounds":{"_southWest":{"lat":7.413342125514235,"lng":3.915112914700764},"_northEast":{"lat":7.414222474485764,"lng":3.916000685299236}},"timestamp":1556785354604,"latitude":7.413782299999999,"longitude":3.9155568,"accuracy":49} %>
        <% for (newweri = 0; newweri < ppas.length; newweri++) { %>

        <a data-statecode="<%= ppas[newweri] %>" data-toggle="pill">

            <div>
                <small class="text-muted"><%= ppas[newweri].name_of_ppa %> </small>
                <small class="text-muted"><%= ppas[newweri].type_of_ppa %> </small>
                <small class="text-muted"><%= ppas[newweri].ppa_address %> </small>

                <% if ( ppas[newweri].ppa_geodata != ('' | null )  ) { %>
                <% var geo = JSON.parse(ppas[newweri].ppa_geodata) %>
                <small class="text-muted">lng is <%= geo.latlng.lng  %> and lat is <%= geo.latlng.lat %></small>
                <% } %>

                <% if ( ppas[newweri].ppa_directions != ('' | null ) ) { %>
                <small class="text-muted">the direction is <%= ppas[newweri].ppa_directions %></small>
                <% } %>
                <br>
            </div>
        </a>

        <% } %>

        <% } else { %>
        <a>uhmmm... nothing ... just for the mean time</a>
        <% } %>


        <% if (accommodations.length > 0) { %>
            <%# {"latlng":{"lat":7.413782299999999,"lng":3.9155568},"bounds":{"_southWest":{"lat":7.413342125514235,"lng":3.915112914700764},"_northEast":{"lat":7.414222474485764,"lng":3.916000685299236}},"timestamp":1556785354604,"latitude":7.413782299999999,"longitude":3.9155568,"accuracy":49} %>
            <% for (newweri = 0; newweri < accommodations.length; newweri++) { %>
    
            <a data-statecode="<%= accommodations[newweri] %>" data-toggle="pill">
    
                <div>
                    <small class="text-muted"><%= accommodations[newweri].statecode %> </small>
                    <small class="text-muted"><%= accommodations[newweri].type %> </small>
                    <small class="text-muted">&#8358; <%= accommodations[newweri].price %> </small>

                    <small class="text-muted"><%= accommodations[newweri].rooms.split(',') %> </small>
                    <small class="text-muted"><%= accommodations[newweri].rentrange %> </small>
                    <small class="text-muted"><%= accommodations[newweri].streetname %> </small>

                    <small class="text-muted"><%= accommodations[newweri].media.split(',') %> </small>
                    <small class="text-muted"><%= accommodations[newweri].address %> </small>
                    <small class="text-muted"><%= accommodations[newweri].tenure %> </small>

                    <small class="text-muted"><%= accommodations[newweri].input_time %> </small>
                    <small class="text-muted"><%= accommodations[newweri].expire %> </small>
    
                    <%# if ( accommodations[newweri].acc_geodata != ('' | null | undefined )  ) { %>
                    <%# var acc_geo = JSON.parse(accommodations[newweri].acc_geodata) %>
                    <!-- <small class="text-muted">lng is <%#= acc_geo.latlng.lng  %> and lat is <%#= acc_geo.latlng.lat %></small> -->
                    <%# } %>
    
                    <% if ( accommodations[newweri].directions != ('' | null ) ) { %>
                    <small class="text-muted">direction is <%= accommodations[newweri].directions %></small>
                    <% } %>
                    <br>
                </div>
            </a>
    
            <% } %>
    
            <% } else { %>
            <a>uhmmm... nothing ... just for the mean time</a>
            <% } %>

    </main>
</body>

</html>